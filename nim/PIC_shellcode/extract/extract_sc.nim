import std/[strformat]
from strutils import toHex

proc generateNimArrayOutput(s: string) =
  echo &"var buf: array[{s.len}, byte] = ["
  var j = 0
  for i in 0 ..< s.len:
    if i == 0:
      stdout.write &"  byte 0x{ord(s[i]):0>2X}, "
      j.inc
    elif (i == s.len - 1):
      stdout.write &"0x{ord(s[i]):0>2X}"
      break
    elif j == 0:
      stdout.write &"  0x{ord(s[i]):0>2X}, "
      j.inc
    elif j < 14:
      stdout.write &"0x{ord(s[i]):0>2X}, "
      j.inc
    else:
      stdout.write &"0x{ord(s[i]):0>2X}, \n"
      j = 0

  echo "\n]"

let 
  mainExe = readFile("../main.exe")
  start = 0x200
  fin = 0x520

let data = mainExe[start .. fin]

writeFile("sc.bin", data)

generateNimArrayOutput(data)